<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>securitylib.throttling.server — Throttling server functions &mdash; Security Lib 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Security Lib 0.1 documentation" href="../index.html" />
    <link rel="up" title="securitylib.throttling — Throttling framework" href="throttling.html" />
    <link rel="prev" title="securitylib.throttling.common — Throttling common functions" href="common.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="common.html" title="securitylib.throttling.common — Throttling common functions"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Security Lib 0.1 documentation</a> &raquo;</li>
          <li><a href="throttling.html" accesskey="U"><tt class="docutils literal"><span class="pre">securitylib.throttling</span></tt> &#8212; Throttling framework</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="common.html"
                        title="previous chapter"><tt class="docutils literal"><span class="pre">securitylib.throttling.common</span></tt> &#8212; Throttling common functions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/throttling/server.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-securitylib.throttling.server">
<span id="securitylib-throttling-server-throttling-server-functions"></span><h1><a class="reference internal" href="#module-securitylib.throttling.server" title="securitylib.throttling.server"><tt class="xref py py-mod docutils literal"><span class="pre">securitylib.throttling.server</span></tt></a> &#8212; Throttling server functions<a class="headerlink" href="#module-securitylib.throttling.server" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="securitylib.throttling.server.StateUpdater">
<em class="property">class </em><tt class="descclassname">securitylib.throttling.server.</tt><tt class="descname">StateUpdater</tt><big>(</big><em>counters_storage</em>, <em>session_storage</em>, <em>config=None</em><big>)</big><a class="headerlink" href="#securitylib.throttling.server.StateUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this class to update the throttling state of client requests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>counters_storage</strong> (<a class="reference internal" href="common.html#securitylib.throttling.common.CountersStorage" title="securitylib.throttling.common.CountersStorage"><tt class="xref py py-class docutils literal"><span class="pre">securitylib.throttling.common.CountersStorage</span></tt></a>) &#8211; Storage to be used for storing throttling counters.</li>
<li><strong>session_storage</strong> (<a class="reference internal" href="common.html#securitylib.throttling.common.SessionStorage" title="securitylib.throttling.common.SessionStorage"><tt class="xref py py-class docutils literal"><span class="pre">securitylib.throttling.common.SessionStorage</span></tt></a>) &#8211; Storage to be used to store sessions.</li>
<li><strong>config</strong> (<tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt>) &#8211; <p>A dictionary containing throttling parameters (dictionary keys are the parameter name
and dictionary values are the parameter value).
Allows defining the limits in requests before the throttling state changes to captcha or block,
and the initial blocking time.</p>
<p>You can omit the whole dictionary or some of its keys as the values
for the missing keys will be taken from the default configuration.</p>
<blockquote>
<div><em>Structure</em>:<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="32%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">limits</span></tt></td>
<td><em>dictionary of dictionaries with integer values</em></td>
<td>This parameter must have up to two dictionaries with keys <tt class="docutils literal"><span class="pre">'captcha'</span></tt>
and <tt class="docutils literal"><span class="pre">'block'</span></tt>, one that contains captcha limits, and another for block limits.<p>If any of these dictionaries is missing, no limits will be imposed
for that throttling method, which effectively disables the throttling method.
This can be used, for example, to disable throttling by captcha for APIs.</p>
<p class="last">Each of these two dictionaries has up to five pairs of keys and values,
where each key is a type of counter and its value
is the limit for the value of the counter before the throttling state is updated,
e.g. if <tt class="docutils literal"><span class="pre">limits['captcha']['user']</span></tt> is 5, the state for the <tt class="docutils literal"><span class="pre">'user'</span></tt> counter
will change to <tt class="docutils literal"><span class="pre">'captcha'</span></tt> when its value increases beyond 5.</p>
</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">initial_blocking_time</span></tt></td>
<td><em>integer</em></td>
<td>Duration in seconds for the first block (subsequent blocks will have
its duration doubled each time).</td>
</tr>
</tbody>
</table>
<p><em>Default configuration</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&#39;limits&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;captcha&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;ip&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s">&#39;user&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s">&#39;pwd&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s">&#39;ip_user&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s">&#39;ip_pwd&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s">&#39;block&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;ip&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s">&#39;user&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">&#39;pwd&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s">&#39;ip_user&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s">&#39;ip_pwd&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s">&#39;initial_blocking_time&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="securitylib.throttling.server.StateUpdater.add_request">
<tt class="descname">add_request</tt><big>(</big><em>ip</em>, <em>user=None</em>, <em>pwd=None</em>, <em>session_id=None</em>, <em>success=False</em>, <em>ctx=''</em><big>)</big><a class="headerlink" href="#securitylib.throttling.server.StateUpdater.add_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Notifies the StateUpdater of the ocurrence of a request, which it will use to update the respective counters
and their state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ip</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; The ip of the client that made the request.</li>
<li><strong>user</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; The user that the client sent in his login request. (used for login attempts)</li>
<li><strong>pwd</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; The password that the client sent in his login request. (used for login attempts)</li>
<li><strong>session_id</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; The session_id for the client&#8217;s session.
Use the same session_id you used in the <tt class="xref py py-func docutils literal"><span class="pre">check_state()</span></tt> call.
This session_id is used only for login requests and thus can be omitted for other requests.</li>
<li><strong>success</strong> (<tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt>) &#8211; Whether the given request succeeded or not. This applies to a login request, for example,
where the login can either succeed or not. Most other requests have no such differentiation, and as such you should
omit this parameter.</li>
<li><strong>ctx</strong> &#8211; The context of the request.
Use the same context you used in the <tt class="xref py py-func docutils literal"><span class="pre">check_state()</span></tt> call.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="common.html" title="securitylib.throttling.common — Throttling common functions"
             >previous</a> |</li>
        <li><a href="../index.html">Security Lib 0.1 documentation</a> &raquo;</li>
          <li><a href="throttling.html" ><tt class="docutils literal"><span class="pre">securitylib.throttling</span></tt> &#8212; Throttling framework</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, SAPO Security Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>