<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>securitylib.passwords — Creation and validation of user passwords. &mdash; Security Lib 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Security Lib 0.1 documentation" href="index.html" />
    <link rel="next" title="securitylib.throttling — Throttling framework" href="throttling/throttling.html" />
    <link rel="prev" title="securitylib.random — Secure generation of random numbers and strings" href="random.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="throttling/throttling.html" title="securitylib.throttling — Throttling framework"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="random.html" title="securitylib.random — Secure generation of random numbers and strings"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Security Lib 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="random.html"
                        title="previous chapter"><tt class="docutils literal"><span class="pre">securitylib.random</span></tt> &#8212; Secure generation of random numbers and strings</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="throttling/throttling.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">securitylib.throttling</span></tt> &#8212; Throttling framework</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/passwords.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-securitylib.passwords">
<span id="securitylib-passwords-creation-and-validation-of-user-passwords"></span><h1><a class="reference internal" href="#module-securitylib.passwords" title="securitylib.passwords: Creation and validation of user passwords."><tt class="xref py py-mod docutils literal"><span class="pre">securitylib.passwords</span></tt></a> &#8212; Creation and validation of user passwords.<a class="headerlink" href="#module-securitylib.passwords" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="securitylib.passwords.prepare_password_for_storage">
<tt class="descclassname">securitylib.passwords.</tt><tt class="descname">prepare_password_for_storage</tt><big>(</big><em>password</em>, <em>authenticator_key</em><big>)</big><a class="headerlink" href="#securitylib.passwords.prepare_password_for_storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this function if you want to store a password.
This function returns a hex representation of the password that is safe to be stored.
It uses a one-way algorithm which means you need to provide the password
you are trying to verify in <a class="reference internal" href="#securitylib.passwords.compare_stored_password" title="securitylib.passwords.compare_stored_password"><tt class="xref py py-func docutils literal"><span class="pre">compare_stored_password()</span></tt></a> as one of the parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>password</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; The password to be prepared for storage.</li>
<li><strong>authenticator_key</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; This key is used to make it harder for an attacker to find the users passwords,
even if he compromises the database.
This is done by making the transformation of the password be unique for the given key
(using the given authenticator_key),
so even if an attacker gets hold of the stored password,
he has no way to verify whether a password matches it without knowing the key.
This also means that this key MUST be stored separate from the stored passwords,
else an attacker that compromises the database will also get hold of this key.
Other recomendations include storing it outside the webserver tree and
with read permissions only for the application that must read it.
You can use <a class="reference internal" href="crypto.html#securitylib.crypto.generate_authenticator_key" title="securitylib.crypto.generate_authenticator_key"><tt class="xref py py-func docutils literal"><span class="pre">generate_authenticator_key()</span></tt></a> to generate it.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt> &#8211; Returns the password prepared for storage.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="securitylib.passwords.compare_stored_password">
<tt class="descclassname">securitylib.passwords.</tt><tt class="descname">compare_stored_password</tt><big>(</big><em>password</em>, <em>authenticator_key</em>, <em>stored_password</em><big>)</big><a class="headerlink" href="#securitylib.passwords.compare_stored_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this function to verify a password given by a user
against a password stored with <a class="reference internal" href="#securitylib.passwords.prepare_password_for_storage" title="securitylib.passwords.prepare_password_for_storage"><tt class="xref py py-func docutils literal"><span class="pre">prepare_password_for_storage()</span></tt></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>password</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; The password to be compared to the stored one.</li>
<li><strong>authenticator_key</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; The key that was used when storing the password, in byte string.</li>
<li><strong>stored_password</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; Stored password against which the given password is to be compared.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt> &#8211; True if the given password matches the stored one.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="securitylib.passwords.generate_password">
<tt class="descclassname">securitylib.passwords.</tt><tt class="descname">generate_password</tt><big>(</big><em>length=12</em>, <em>lower=True</em>, <em>upper=True</em>, <em>digits=True</em>, <em>special=True</em>, <em>ambig=True</em><big>)</big><a class="headerlink" href="#securitylib.passwords.generate_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a password according to the given parameters.
It is guaranteed that if a type of characters (lower, upper, etc.) is allowed in the password,
then the generated password will always contain at least one character of that type,
e.g. if the parameter special is True, then the generated password will have at least a special character.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>length</strong> (<tt class="xref py py-class docutils literal"><span class="pre">int</span></tt>) &#8211; Length of the generated password. Must be at least 8.</li>
<li><strong>lower</strong> (<tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt>) &#8211; Whether the password should contain lower case characters.</li>
<li><strong>upper</strong> (<tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt>) &#8211; Whether the password should contain upper case characters.</li>
<li><strong>digits</strong> (<tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt>) &#8211; Whether the password should contain digits.</li>
<li><strong>special</strong> (<tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt>) &#8211; Whether the password should contain special characters (!&#64;#$%^&amp;*).</li>
<li><strong>ambig</strong> (<tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt>) &#8211; Whether the password should contain ambiguous characters (iloILO10).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">str</span></tt> &#8211; The generated password.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="securitylib.passwords.validate_password">
<tt class="descclassname">securitylib.passwords.</tt><tt class="descname">validate_password</tt><big>(</big><em>password</em>, <em>min_length=12</em>, <em>min_lower=1</em>, <em>min_upper=1</em>, <em>min_digits=1</em>, <em>min_special=1</em>, <em>min_strength=50</em><big>)</big><a class="headerlink" href="#securitylib.passwords.validate_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates a given password against some basic rules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>password</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; Password to validate.</li>
<li><strong>min_length</strong> (<tt class="xref py py-class docutils literal"><span class="pre">int</span></tt>) &#8211; Minimum length that the password must have.</li>
<li><strong>min_lower</strong> (<tt class="xref py py-class docutils literal"><span class="pre">int</span></tt>) &#8211; Minimum number of lower case characters that the password must contain.</li>
<li><strong>min_upper</strong> (<tt class="xref py py-class docutils literal"><span class="pre">int</span></tt>) &#8211; Minimum number of upper case characters that the password must contain.</li>
<li><strong>min_digits</strong> (<tt class="xref py py-class docutils literal"><span class="pre">int</span></tt>) &#8211; Minimum number of digits that the password must contain.</li>
<li><strong>min_special</strong> (<tt class="xref py py-class docutils literal"><span class="pre">int</span></tt>) &#8211; Minimum number of special characters (!&#64;#$%^&amp;*) that the password must contain.</li>
<li><strong>min_strength</strong> (<tt class="xref py py-class docutils literal"><span class="pre">bool</span></tt>) &#8211; Minimum strength that the password must have according to function <a class="reference internal" href="#securitylib.passwords.get_password_strength" title="securitylib.passwords.get_password_strength"><tt class="xref py py-func docutils literal"><span class="pre">get_password_strength()</span></tt></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">list</span></tt> &#8211; A list with the name of the parameters whose validations have failed.
This means a password is valid only if this function returns an empty list.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="securitylib.passwords.get_password_strength">
<tt class="descclassname">securitylib.passwords.</tt><tt class="descname">get_password_strength</tt><big>(</big><em>password</em>, <em>username=None</em><big>)</big><a class="headerlink" href="#securitylib.passwords.get_password_strength" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a password&#8217;s strength according to some heuristics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>password</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; Password to evaluate.</li>
<li><strong>username</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; Username of the password&#8217;s owner. When provided, the password strength will
be lower if it contains the given username. If the username is an email,
both the whole email and its left part will be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">int</span></tt> &#8211; Strength of the password as an int between 0 and 100.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="securitylib.passwords.get_entropy_bits">
<tt class="descclassname">securitylib.passwords.</tt><tt class="descname">get_entropy_bits</tt><big>(</big><em>password</em>, <em>username=None</em><big>)</big><a class="headerlink" href="#securitylib.passwords.get_entropy_bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a password&#8217;s strength according to some heuristics.
Returns the entropy of the given password in bits.</p>
<p>E.g. a password with 8 characters, lowercase + digits,
without dictionary words and without keyboard sequences, will have entropy about 26.
If it had also uppercase characters the entropy would be about 30.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>password</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; Password to evaluate.</li>
<li><strong>username</strong> (<tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>) &#8211; Username of the password&#8217;s owner. When provided, the password strength will
be lower if it contains the given username. If the username is an email,
both the whole email and its left part will be used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>returns: <tt class="xref py py-class docutils literal"><span class="pre">int</span></tt> &#8211; Number of bits of entropy that the password has.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="throttling/throttling.html" title="securitylib.throttling — Throttling framework"
             >next</a> |</li>
        <li class="right" >
          <a href="random.html" title="securitylib.random — Secure generation of random numbers and strings"
             >previous</a> |</li>
        <li><a href="index.html">Security Lib 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, SAPO Security Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>